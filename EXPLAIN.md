# フラワーアレンジメント WebGL 解説（初心者向け）

## プロジェクトで何ができる？
- p5.js の WebGL 機能で 3D の花束を描きます（花は全部で 5 本）。
- 画面右のスライダーで花びらの数や回転速度などをリアルタイムに変更できます。
- ガラスのように透けたコントロールパネルと、スマホでも操作しやすいレイアウトを採用しています。

## 画面のつくりかた（`index.html`）
- **レイアウト:** `#container` の中にコントロールパネルと描画用エリア（キャンバス）を横並びで配置。画面が狭いときは縦並びに切り替わります。
- **コントロール:** 花びら数、花の大きさ、三角形リングの数、回転速度を変えるスライダーがあり、横の数字が現在値を表示します。
- **ボタン:** `Generate New Arrangement` は新しい花束をランダムに作り直し、`Save Image` は表示中の絵を PNG として保存します。
- **レスポンシブ対応:** CSS のメディアクエリで余白や文字サイズ、スライダーのサイズを調整。スマホでは先にキャンバスを表示し、コントロールは下へ移動します。

## スケッチの動き（`sketch.js`）
- **設定データ:** `flowerSettings` にスライダーで変えられる数値を保存。`flowers` と `particles` で花と浮遊パーティクルを管理します。
- **setup():** 画面サイズに合わせて正方形の WebGL キャンバスを作成し、色モードを HSB に変更。コントロールのイベントを登録し、最初の花束を生成します。
- **windowResized():** ブラウザのサイズが変わったらキャンバスも追従させます。
- **setupControls():** 各スライダーの `input` イベントで `flowerSettings` を更新し、表示中の数値も書き換えます。ボタンは `generateFlower()` と `saveCanvas()` を呼びます。
- **generateFlower():** 5 本の花を中央・左上・右上・左下・右下に配置。大きさや花びら数は中心の花を基準に比率で決めています。同時に 30 個の浮遊パーティクルも生成します。
- **draw():** 背景を塗りつぶし、`orbitControl()` でマウスドラッグやズームを有効化。全体を少し傾けてから各花を描画し、最後に浮遊パーティクルを処理します。

## Flower クラスの役割
- **花びらの並び方:** コンストラクタで黄金角（137.5°）を使い、球体の表面に花びらを均等配置します。
- **花びらのアニメーション:** `drawPetals()` で花びらの角度を合わせ、サイン波で揺れと長さの変化を付け、小さな球体でつぼみのような先端を描きます。
- **中心の鼓動:** `drawCenter()` は中心球を描いて、ゆっくり脈打つようにサイズを変えます。
- **光る粒の輪:** `drawFx()` は 120 個の粒を花の周囲に配置し、回転移動させてきらめきを出します。
- **三角形リング:** `drawTriangleRing()` は花の半径をもとにリングを作り、回転させてアクセントにします。
- **display():** 上記の描画メソッドを順番に呼び出して、レイヤーがきれいに重なるようにします。

## 浮遊パーティクル
- `generateFlower()` でランダムな位置・速度・回転を持つパーティクルを追加します。
- `updateParticles()` で位置を更新し、一定より下に落ちた粒は上側へ戻してシーンを保ちます。
- `drawParticles()` で柔らかい輪郭の小さな葉のような形を描き、全体の雰囲気を豊かにします。

## 見た目と操作のポイント
- HSB のモノクローム（白〜グレー）の色使いで未来的な印象をつくります。
- ガラス調のパネルは半透明の背景・細い枠線・ドロップシャドウで表現しています。
- パーティクルや揺れアニメーションは軽量に保ちつつ、動きの豊かさを演出します。

## 使い方
1. ブラウザで `index.html` を開きます（ローカルでも静的ホスティングでも OK）。
2. マウスドラッグで視点を回転、スクロールでズーム、`Shift` + ドラッグで平行移動します。
3. スライダーを調整して好みの形を探し、気に入ったら `Save Image` で PNG を保存します。

## さらに発展させるヒント
1. `flowerSettings` に新しい項目を追加し、スライダーや `generateFlower()` を拡張するとプリセットや花の種類を増やせます。
2. `drawPetals()` や `drawFx()` の色指定を変えてカラーパレットを切り替える仕組みを作ってみましょう。
3. パーティクル数やアニメーション速度を設定できるようにし、低スペック端末向けの軽量モードを追加するのもおすすめです。
